
import streamlit as st
import yfinance as yf

st.set_page_config(page_title="V3 SHIELD", page_icon="üõ°Ô∏è")

st.title("üõ°Ô∏è V3 SHIELD - Apple Milano")

# Dati del tuo investimento
PREZZO_CARICO = 222.0
STOP_LOSS = 211.0
QUANTITA = 2

try:
    # Scarica i dati da Borsa Italiana
    df = yf.download("AAPL.MI", period="5d", interval="1h", progress=False)
    
    if not df.empty:
        prezzo_attuale = float(df['Close'].iloc[-1])
        variazione = prezzo_attuale - PREZZO_CARICO
        percentuale = (variazione / PREZZO_CARICO) * 100

        # Visualizzazione Metriche
        col1, col2 = st.columns(2)
        col1.metric("Prezzo Attuale", f"{prezzo_attuale:.2f} ‚Ç¨")
        col2.metric("P/L Totale", f"{variazione * QUANTITA:.2f} ‚Ç¨", f"{percentuale:.2f}%")

        st.warning(f"‚ö†Ô∏è STOP LOSS ATTIVO A: {STOP_LOSS} ‚Ç¨")
        
        # Grafico
        st.line_chart(df['Close'])
    else:
        st.error("Dati non disponibili al momento.")
except Exception as e:
    st.error(f"Errore tecnico: {e}")

st.info("Protocollo Prudenza: Monitoraggio attivo 24/7")
